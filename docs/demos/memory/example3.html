{% include "chrome-developer-tools/_local_variables.html" %}
<!DOCTYPE html>
<html devsite>
<head>
  <title>Example 3</title>
  <link rel="stylesheet" href="stylesheets/style.css" type="text/css">
    <meta name="project_path" value="/chrome-developer-tools/_project.yaml" />
    <meta name="book_path" value="/chrome-developer-tools/_book.yaml" />
</head>

<body>
  {% framebox height="100px" %}
  <h1>Example 3: Scattered objects</h1>
  <p><button onclick="init()">Create scattered objects</button></p>
  <script>
  function Item(x) {
  this.x = x;
}

function numbers() {
  var result = new Array(10000);
  for (var i = 0, l = result.length; i < l; ++i)
    result[i] = new Item(i);
  return new Item(result);
}

function strings() {
  var result = new Array(10000);
  for (var i = 0, l = result.length; i < l; ++i)
    result[i] = new Item(i.toString());
  return new Item(result);
}

function init() {
  numberCache = numbers();
  stringCache = strings();
  documentCache = new Item(document.body.textContent.toLowerCase());
}

</script>
  {% endframebox %}

  <p>Take a heap stapshot and watch the objects (Item) allocations.</p>
  <hr>
  <pre>
function Item(x) {
  this.x = x;
}

function numbers() {
  var result = new Array(10000);
  for (var i = 0, l = result.length; i &lt; l; ++i)
    result[i] = new Item(i);
  return new Item(result);
}

function strings() {
  var result = new Array(10000);
  for (var i = 0, l = result.length; i &lt; l; ++i)
    result[i] = new Item(i.toString());
  return new Item(result);
}

function init() {
  numberCache = numbers();
  stringCache = strings();
  documentCache = new Item(document.body.textContent.toLowerCase());
}
</pre>
</body>
</html>
